<html lang="es">
<head>
	<title>topònims valencians</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="autor"/>
	<meta name="description" content="descripción página">
	<meta name="robots" content="index,follow">
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
	<link rel="stylesheet" href="css/leaflet-search.min.css" />
	
	<style>
		body {
			margin: 0;
			padding: 0;
			overflow: hidden;
		}
		
		#map {
			height: 100%;
			width: 100%;
			background-color: #ffffff
		}
		
		#titulo{
			position: absolute;
			width: 150px;
			top:5px;
			left:40%
			z-index:1;
			background-color: gray;
			color: #ffffff;
			padding:13px;
			opacity:0.7;
			border-radius:8px;
			font-family: calibri;
			font-size:14px;
			left:50px;
			top:10px;
		}
		
	</style>
	
	<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
	<script src="js/leaflet.ajax.min.js"></script>
	<script src="js/leaflet-search.min.js"></script>
	
	<script>
			var map;
			var osm;
			var esri;
			var capaGeoJson
			var controlCapas;
		
		function init(){
		
			map = L.map('map', {
					center: [39.465967, -0.377512],
					zoom: 7
			});
			
			esri = L.tileLayer(
				'http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
				{
					maxZoom : 19,
					minZoom : 7,
					attribution : 'Tiles © Esri',

				}).addTo(map);

				
			osm = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', 
				{
					maxZoom: 19,
					minZoom: 7,
					attribution: 'OSM'
				});
							
						
			var capaGeoJson=L.geoJson.ajax('../datos/pais_valencia.geojson', {

				style: function (feature) {
					var _color={color:'#ffffff',weight:1,fillOpacity:0.5,fillColor:'#000000'};
							
					if(feature.properties.NORM == 'Sí, nom en valencià'){
					_color={color:'#ffffff',weight:1,fillOpacity:0.5,fillColor:'#118409'};
					}
					
					if(feature.properties.NORM == 'Sí, nom en castellà'){
					_color={color:'#ffffff',weight:1,fillOpacity:0.5,fillColor:'#0BE21D'};
					}
					
					if(feature.properties.NORM == 'No, nom en castellà'){
					_color={color:'#ffffff',weight:1,fillOpacity:0.5,fillColor:'#BC0325'};
					}
					
					if(feature.properties.NORM == 'No, denominació bilingüe'){
					_color={color:'#ffffff',weight:1,fillOpacity:0.5,fillColor:'#E27E0B'};
					}
					
					if(feature.properties.NORM == 'No s´ajusta a la norma AVL'){
					_color={color:'#ffffff',weight:1,fillOpacity:0.5,fillColor:'#E2C90B'};
					}
					
					return _color;
				},

					onEachFeature: function(feature, layer) {
							popupContent =
							"<br>Nom oficial: "+feature.properties.NOM_OFICIAL+"</br>"+
							"<br>Població: "+feature.properties.T_2016+"</br>"+
							"<br>Nom recomanat per l´AVL: "+feature.properties.NOM_AVL+"</br>"+
							"<br>Comarca: "+feature.properties.COMARCA+"</br>"+
							"<br>Província: "+feature.properties.PROVINCIA+"</br>"+
							"<br>Predomini lingüístic: "+feature.properties.PRED+"</br>"+
							"<br>Topònim normalitzat?: "+feature.properties.NORM+"</br>"
							;
							layer.bindPopup(popupContent);
					}
				}).addTo(map);
				
			var searchControl = new L.Control.Search({
					layer: capaGeoJson,
					propertyName: 'NOM_OFICIAL',
					circleLocation: true
				});

				searchControl.on('search_locationfound', function(feature) {
					feature.layer.setStyle({
						fillColor: '#ff0000',
						weight: 2,
						opacity: 1,
					});

				}).on('search_collapsed', function() {
					  capaGeoJson.eachLayer(function(layer) {
							capaGeoJson.resetStyle(layer);
					});
				});
				
				map.addControl(searchControl);
						
				
				
		 }

	</script>
</head>
<body onLoad="init()">
	<div id="map"></div>
	<div id="titulo">la normalització lingüística dels topònims valencians</div>
</body>
</html>
